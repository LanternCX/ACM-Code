**题目**：简单计算器

**PTA判题得分**：50

### 一、问题描述

模拟简单运算器的工作。假设计算器只能进行加减乘除运算，运算数和结果都是整数，四种运算符的优先级相同，按从左到右的顺序计算。

**输入格式:**

输入在一行中给出一个四则运算算式，没有空格，且至少有一个操作数。遇等号”=”说明输入结束。

**输出格式:**

在一行中输出算式的运算结果，或者如果除法分母为0或有非法运算符，则输出错误信息“ERROR”。

**输入样例:**

```in
1+2*10-10/2=
```

**输出样例:**

```out
10
```

### 二、数据结构定义与分析

本次实验中定义了以下3个变量（包含2个整型变量，1个字符变量）：

- `ans` 用于存储当前的计算结果且作为最终答案，初始化为输入的第一个操作数；（整型变量）
- `ch` 用于存储当前读取的运算符，用于判断并执行相应的四则运算；（字符变量）
- `num` 用于存储输入的下一个操作数，参与运算；（整型变量）

### 三、算法分析

4. 先根据题意读取用户输入的第一个数字；  
5. 利用循环`while((ch = getchar()) != '=')`逐个读取运算符，并判断是否遇到等号`=`终止循环；  
6. 在每次循环中：

    - 读取当需要执行运算的数字；
    - 根据当前运算符，执行对应运算，并对计算结果（`ans`）进行更新；
    - 如果除法分母为0则输出错误信息`ERROR`并退出循环；
    - 如果出现非法字符则输出错误信息`ERROR`并退出循环；
4. 在所有运算完成后输出最终结果(若中途出现错误，则提前输出 `ERROR`) 。

### 四、测试用例设计及测试结果

#### 1. 样例测试

**输入：**

```in
1+2*10-10/2=
```

**预期输出：**

```
10
```

**实际输出：**



#### 2. 分母为0测试

**输入：**

```
1+2*10-10/0=
```

**预期输出：**

```
ERROR
```

**实际输出：**



#### 3. 非法字符测试

**输入：**

```
1+2^10-10/0=
```

**预期输出：**

```
ERROR
```

**实际输出：**

#### 3. 最小表达式

**输入：**

```
1=
```

**预期输出：**

```
1
```

**实际输出：**



从以上测试当中可以检验出程序的完备性

### 五、存在问题及可能原因

1. **运算符处理问题**  
   - **问题**：当输入包含非法字符时，程序没有正确处理错误情况。  
   - **原因**：在`swtich`语句中没有使用`default`判断是否输入了非法字符
4. **除法错误处理问题**  
   - **问题**：输入包含除数为零时，程序没有正确处理错误情况。  
   - **原因**：在`swtich`语句中`case '/'`中没有判断输入的分母是否为0
3. **`switch`语句没有正确`break`问题**
   - **问题**：`case`没有正确`break`
   - **原因**：在`swtich`语句中`case`结束时需`break;`否则会导致`case`继续判断

### 六、附源代码以及代码相应注释

```c++
// 输入输出头文件
#include <stdio.h>

// 主函数，程序入口
int main(){
    // 运算符
    char ch;
    // 答案，初值为输入的第一个数
    int ans;
    // 输入数字
    scanf("%d", &ans);
    // 循环读取运算符和数字，到出现 '=' 循环终止
    while((ch = getchar()) != '='){
        // 被执行运算的数字
        int num;
        // 输入数字
        scanf("%d", &num);
        // 利用 switch 语句对运算符进行判断以执行相应的计算
        switch(ch){
            // 执行加法
            case '+':
                ans += num;
                break;
            // 执行减法
            case '-':
                ans -= num;
                break;
            // 执行乘法
            case '*':
                ans *= num;
                break;
            // 执行除法
            case '/':
                // 判断除法分母是否合法
                if(num == 0){
                    // 如果分母非法则打印 ERROR 并退出程序
                    printf("ERROR");
                    return 0;
                }
                // 执行除法
                ans /= num;
                break;
            // 非法字符则打印 ERROR
            default:
                printf("ERROR");
                return 0;
        }
    }
    // 打印最终答案
    printf("%d", ans);
    return 0;
}
```

### 七、实验总结及建议

本次实验相比一般的题目程序复杂度较高，其中运用到了`getchar()`输入字符，使用`while(ch = getchar()) != '='`判断循环是否退出，使用`switch - case - default`进行条件的判断，以及字符和整数的运算等等。实验较为综合，通过本次实验发现，本人编程熟练程度不够，编程速度太慢。
